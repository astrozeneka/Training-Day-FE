<ion-header>
  <ion-toolbar>
      <ion-buttons slot="start">
          <app-back-button></app-back-button>
          <ion-menu-button></ion-menu-button>
      </ion-buttons>
      <ion-title>
          Confirmez votre achat
      </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <h1 class="display-1 ion-padding">Facture</h1>

  <div class="ion-padding">
      <table>
          <thead>
          <tr>
              <th></th>
              <th>Désignation</th>
              <th>Prix TTC</th>
          </tr>
          </thead>
          <tbody>
            <tr *ngIf="productList && productId">
              <td>1</td>
              <td>
                {{ productList[productId]?.displayName }} <br/>
                <!-- todo later , promotional text if there is any -->
              </td>
              <td>
                {{ productList[productId]?.displayPrice }}
                <span *ngIf="['hoylt', 'alonzo', 'moreno', 'gursky', 'smiley'].includes(productId)">/ mois</span>
              </td>
            </tr>
            <!-- The total -->
            <tr>
              <td></td>
              <td><strong>Total</strong></td>
              <td *ngIf="productList && productId">
                <strong>{{ productList[productId].displayPrice }}
                  <span *ngIf="['hoylt', 'alonzo', 'moreno', 'gursky', 'smiley'].includes(productId)">/ mois</span>
                </strong>
                <!-- Todo, promotional offer if there is -->
              </td>
            </tr>
          </tbody>
        </table>
    </div>

    <!-- Todo later, the promotional offer, should consider to use a shared component to load them -->
    
    
    <form>
      <ion-item>
          <ion-label>Accepter <a class="a" (click)="openCGV()">les conditions générales de vente</a></ion-label>
          <ion-checkbox [formControl]="acceptConditions" slot="end" color="primary"></ion-checkbox>
      </ion-item>
    </form>
    <div class="ion-padding">
      <app-ux-button
        expand="block" 
        color="primary" 
        shape="round" 
        (click)="continueToPayment()" 
        [disabled]="!acceptConditions.value"
        [loading]="isLoading"
      >
        Continuer
      </app-ux-button>
      <!-- TODO, redeem code -->
      <div class="helper ion-text-center" *ngIf="isLoading" style="font-size:smaller">
        Enregistrement de votre commande en cours <br/>
        <div>
            <span>
                {{ loadingStep }}
            </span>
            <ion-spinner name="dots"></ion-spinner>
        </div>
      </div>
    </div>
</ion-content>
