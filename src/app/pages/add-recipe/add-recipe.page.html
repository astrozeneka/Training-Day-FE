<ion-header>
  <ion-toolbar>
      <ion-buttons slot="start">
          <app-back-button></app-back-button>
          <ion-menu-button></ion-menu-button>
      </ion-buttons>
      <ion-title>Ajouter une recette</ion-title>
      <ion-progress-bar [value]="progress" *ngIf="progress"></ion-progress-bar>
  </ion-toolbar>
</ion-header>

<ion-content>
  <h1 class="display-1 ion-padding">Ajouter une recette</h1>
  <form [formGroup]="form" (submit)="submit()">

    <!-- ion-item is deprecated and will be removed later -->
    <div class="input-wrapper">
      <app-outline-input
        label="Titre"
        formControlName="title"
        [errorText]="displayedError.title"
      ></app-outline-input>
    </div>
    <!--<ion-item>
      <ion-input
        label="Titre"
        label-placement="floating"
        formControlName="title"
        [errorText]="displayedError.title"
      ></ion-input>
    </ion-item>-->

    <!-- Will be changed to text area later (not now) -->
    <div class="input-wrapper">
      <app-outline-input
        label="Description"
        formControlName="description"
        [errorText]="displayedError.description"
      ></app-outline-input>
    </div>
    
    <!--<ion-item>
      <ion-textarea
              label="Description"
              label-placement="floating"
              formControlName="description"
              [rows]="5"
              [errorText]="displayedError.description"
      ></ion-textarea>
    </ion-item>-->

    <div class="input-wrapper">
      <app-outline-input
        label="Catégorie"
        formControlName="category"
        [errorText]="displayedError.category"
      ></app-outline-input>
      <div class="chip-list">
        <ion-chip *ngFor="let c of categories" (click)="chooseCategory({val:c})"
          [color]="c === form.get('category').value ? 'primary' : 'medium'"
        >{{ c }}</ion-chip>
      </div>
    </div>

    <!-- Image picker -->
    <div class="image-picker-wrapper">
      <div class="label">
        Image représentative
      </div>
      <app-image-picker
        color="light"
        label="Image"
        accept="image/png,image/jpeg"
        formControlName="image"
        [errorText]="displayedError.image"
      ></app-image-picker>
    </div>

    <!-- PDF pickers -->
    <div class="image-picker-wrapper">
      <div class="label">
        Visuel pour petit smartphone (facult.)
      </div>
      <app-image-picker
        color="light"
        label="Sélectionner un fichier"
        accept="image/png,image/jpeg,image/tiff"
        formControlName="docSmallPhone"
        [errorText]="displayedError.docSmallPhone"
        mode="image"
      ></app-image-picker>
    </div>
    
    <!-- PDF pickers -->
    <div class="image-picker-wrapper">
      <div class="label">
        Visuel pour smartphone
      </div>
      <app-image-picker
        color="light"
        label="Sélectionner un fichier"
        accept="image/png,image/jpeg,image/tiff"
        formControlName="docLargePhone"
        [errorText]="displayedError.docLargePhone"
        mode="image"
      ></app-image-picker>
    </div>
    
    <!-- PDF pickers -->
    <div class="image-picker-wrapper">
      <div class="label">
        Visuel pour tablette (facult.)
      </div>
      <app-image-picker
        color="light"
        label="Sélectionner un fichier"
        accept="image/png,image/jpeg,image/tiff"
        formControlName="docTablet"
        [errorText]="displayedError.docTablet"
        mode="image"
      ></app-image-picker>
    </div>

    <div class="controls">
      <app-ux-button expand="block" [disabled]="!valid" shape="round" [loading]="isFormLoading" *ngIf="formMode=='add'">Ajouter</app-ux-button>
      <app-ux-button expand="block" [disabled]="!valid" shape="round" [loading]="isFormLoading" *ngIf="formMode=='edit'">Mettre à jour</app-ux-button>
      <app-ux-button *ngIf="formMode == 'edit'" type="button" expand="block" fill="clear" color="danger" (click)="promptDelete()" [loading]="deleteIsLoading">Supprimer</app-ux-button>
    </div>
  </form>
</ion-content>
